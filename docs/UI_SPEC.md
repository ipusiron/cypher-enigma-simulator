# Cypher Enigma Simulator 画面仕様書

## 1. 画面構成

単一ページ構成（縦スクロール）。タブで機能を切り替え。

---

## 2. ヘッダー

- ツール名: Cypher Enigma Simulator
- サブタイトル: 暗号解読ゲーム「Cypher」用の簡易エニグマシミュレーター
- ヘルプボタン（右上）: 使い方モーダルを表示

---

## 3. タブナビゲーション

| タブ名 | 説明 |
|--------|------|
| 暗号化・復号 | メイン機能（暗号化/復号処理） |
| 解析支援 | 既知平文攻撃によるスクランブラー初期位置探索 |

---

## 4. 設定エリア（Settings）

### 4.1 プラグボード（Plugboard）

- ON/OFFトグル（デフォルト: OFF）
- テキスト入力: 文字ペア指定（例: `A-B, S-Z`）
- 補足: 未指定文字はそのまま通過

### 4.2 スクランブラー（Scrambler 1-3）

- ON/OFFトグル
  - Scrambler 1: デフォルトON
  - Scrambler 2, 3: デフォルトOFF
- プリセット選択:
  - カスタム
  - Enigma I〜V
- 配線入力（26文字）
- 開始位置（A-Z、デフォルト: A）

### 4.3 リフレクター（Reflector）

- ON/OFFトグル（デフォルト: ON）
- プリセット選択:
  - カスタム
  - Reflector B（デフォルト）
  - Reflector C
- 配線入力（26文字）

### 4.4 モード切替（Mode）

- ラジオボタン
  - 暗号化（Encrypt）: デフォルト
  - 復号（Decrypt）
- 補足: 復号時は逆方向に回転

---

## 5. 入力バリデーション

- 配線: 26文字必須、A-Zのみ、重複不可
- エラー時:
  - 入力欄を赤枠でハイライト
  - エラーメッセージを表示

---

## 6. 入力エリア

- 複数行テキスト入力
- リアルタイム処理対応（300msデバウンス）
- A-Z以外はそのまま通過

---

## 7. アクションボタン

| ボタン | 機能 |
|--------|------|
| 処理実行 | 暗号化/復号を実行 |
| 設定URLをコピー | 現在の設定をURLパラメータ化してコピー |
| リセット | 全設定を初期状態に戻す（確認モーダル付き） |

---

## 8. 出力エリア

- 読み取り専用テキスト
- コピーボタン付き

---

## 9. 内部状態ログ

- `<pre>`表示（等幅フォント）
- 表示内容:
  - 配線設定（配線一覧）
  - 各文字の処理過程
  - 入出力矢印（↓↑）による視覚化
  - スクランブラーのシフト状態
- コピーボタン付き

---

## 10. フッター

- GitHubリポジトリへのリンク

---

## 11. モーダル

### 11.1 ヘルプモーダル

- 概要、設定項目説明、使用手順、ログの見方、注意事項

### 11.2 確認モーダル

- リセット時の確認ダイアログ
- キャンセル/リセットボタン

### 11.3 適用確認モーダル

- 既知平文攻撃結果の設定適用時の確認ダイアログ
- メッセージ: 「スクランブラーの初期位置を X-Y-Z に設定しますか？」
- キャンセル/適用ボタン

---

## 12. 解析支援タブ

### 12.1 概要

既知平文攻撃機能を提供。スクランブラーの配線はわかっているが、初期位置が不明な場合に使用。

### 12.2 設定エリア（独自）

解析支援タブは独自の設定を持つ（メインタブとは独立）:
- プラグボード（ON/OFFトグル＋ペア入力）
- スクランブラー 1-3（ON/OFFトグル＋プリセット選択＋配線入力）
- リフレクター（ON/OFFトグル＋プリセット選択＋配線入力）

### 12.3 入力エリア

#### 暗号文入力
- 複数行テキスト入力
- ASCII文字のみ許可（全角文字ブロック）
- 入力時に既知平文グリッドを自動生成

#### 既知平文グリッド
- 暗号文の各アルファベットに対応する1文字入力欄を横並びで表示
- 非アルファベット文字は表示のみ（入力欄なし）
- 空欄は「不明」を意味
- 複数の断片的な既知平文を入力可能
- キーボードナビゲーション（Tab, 矢印キー, Backspace）対応

### 12.4 探索実行

- 探索空間表示（26^n 通り）
- 「探索実行」ボタン
- エラーメッセージ領域
- プログレス表示

### 12.5 結果表示

各候補について以下を表示:
- スクランブラー初期位置（例: A-B-C）
- 復号結果全文
- 特定理由（どの位置でどの文字が一致したか）
- 「設定に適用」ボタン → 適用確認モーダル → メインタブに反映

---

## 13. データ永続化

| 方式 | 用途 |
|------|------|
| localStorage | 設定の自動保存・復元 |
| URLパラメータ | 設定の共有（優先読み込み） |

---

## 14. UI設計方針

- 教育・検証重視
- 冗長ログを許容
- セキュリティ: 全入力をサニタイズ
- レスポンシブ対応（タブレット600px+、PC900px+）
